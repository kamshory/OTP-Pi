function addItem(a){var e=a.active?"icon-check":"icon-cross",f=a.defaultModem?"icon-check":"icon-cross",b="",g=a.connected||a.internetConnected;b+=a.active?" enable":" disable",b+=g?" connected":" disconnected",b+=a.internetAccess?" service-modem-internet":" service-modem-sms";var d="";void 0!==a.signalStrength&& void 0!==a.signalStrength.class&&(d=" "+a.signalStrength.class);var c=$('<div class="service-item service-modem'+b+'">\r\n<div class="signal-level"><div class="signal-icon'+d+'"><div class="signal-bar"></div><div class="signal-bar"></div><div class="signal-bar"></div><div class="signal-bar"></div></div></div>\r\n<div class="service-label"></div>\r\n<div class="service-button">\r\n<button class="btn btn-sm btn-success connect">Connect</button>\r\n<button class="btn btn-sm btn-danger disconnect">Disonnect</button>\r\n<button class="btn btn-sm btn-primary test-at">Test</button>\r\n<button class="btn btn-sm btn-primary signal">Signal</button>\r\n</div>\r\n</div>');c.attr("data-id",a.id),c.find(".service-label").text(a.name+" via "+a.port),$(".service-wrapper").append(c),$(".row-table tbody").append('<tr data-pk-id="'+a.id+'">\r\n<td><input type="checkbox" class="check-all" name="id[]" value="'+a.id+'"></td>\r\n<td><a href="modem-update.html?id='+encodeURIComponent(a.id)+'">'+a.name+'</a></td>\r\n<td><a href="modem-update.html?id='+encodeURIComponent(a.id)+'">'+a.port+'</a></td>\r\n<td align="center"><span class="icon '+f+'"></span></td>\r\n<td align="center"><span class="icon '+e+'"></span></td>\r\n</tr>\r\n')}function requestModemSignal(a){$.ajax({url:"api/device",type:"POST",dataType:"json",data:{action:"request-signal-strength",id:a},success:function(a){}})}function updateModemUI(a){for(var b in a)if(a.hasOwnProperty(b)){var c=b;$(".service-modem").filter('[data-id="'+c+'"]').removeClass("disconnected"),$(".service-modem").filter('[data-id="'+c+'"]').removeClass("connected");var d=$(".service-modem").filter('[data-id="'+c+'"]').find(".signal-icon");d.attr({class:"signal-icon"}),void 0!==a[b].signalStrength&& void 0!==a[b].signalStrength.class&&d.addClass(a[b].signalStrength.class),a[b].connected||a[b].internetConnected?$(".service-modem").filter('[data-id="'+c+'"]').addClass("connected"):$(".service-modem").filter('[data-id="'+c+'"]').addClass("disconnected")}}function handleIncommingMessage(a){updateModemUI(getModemData())}$(document).ready(function(a){requestModemSignal(""),setInterval(function(){requestModemSignal("")},5e3),$.ajax({type:"GET",url:"data/modem/list",dataType:"json",success:function(a){for(let b in a)a.hasOwnProperty(b)&&addItem(a[b])}}),$(document).on("click",".service-modem-sms .connect",function(b){var a=$(this).closest(".service-item").attr("data-id");$.ajax({url:"api/device",type:"POST",dataType:"json",data:{action:"connect",id:a},success:function(a){if("broadcast-message"==a.command)for(var b in a.data)showNotif(a.data[b].message)}})}),$(document).on("click",".service-item .signal",function(a){requestModemSignal($(this).closest(".service-item").attr("data-id"))}),$(document).on("click",".service-item .test-at",function(b){var a=$(this).closest(".service-item").attr("data-id");$.ajax({url:"api/device",type:"POST",dataType:"json",data:{action:"test-at",id:a},success:function(a){if("broadcast-message"==a.command)for(var b in a.data)showNotif(a.data[b].message)}})}),$(document).on("click",".service-modem-internet .connect",function(b){var a=$(this).closest(".service-item").attr("data-id");$.ajax({url:"api/internet-dial",type:"POST",dataType:"json",data:{action:"connect",id:a},success:function(a){if("broadcast-message"==a.command)for(var b in a.data)showNotif(a.data[b].message)}})}),$(document).on("click",".service-modem-sms .disconnect",function(b){var a=$(this).closest(".service-item").attr("data-id");$.ajax({url:"api/device/",type:"POST",dataType:"json",data:{action:"disconnect",id:a},success:function(a){}})}),$(document).on("click",".service-modem-internet .disconnect",function(b){var a=$(this).closest(".service-item").attr("data-id");$.ajax({url:"api/internet-dial/",type:"POST",dataType:"json",data:{action:"disconnect",id:a},success:function(a){}})})})