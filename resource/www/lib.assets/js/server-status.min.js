function newDateString(a){return moment(a).format()}function prepareTimeSelector(){var h=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],a=new Date;a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0);for(var d=a.getTime(),b=0;b<7;b++){var c=d-(b+0)*864e5,e=d-(b-1)*864e5;a.setTime(c);var f=h[a.getDay()]+" "+a.getDate()+" "+i[a.getMonth()]+" "+a.getFullYear(),g="";g=b>0?'<option value="'+c+","+e+'">'+f+"</option>":'<option data-reload-data="true" value="'+c+","+e+'">'+f+"</option>",$("#time").append(g)}}function loadChart(){$.ajax({type:"GET",url:"data/server-status/get",dataType:"json",data:{time:$("#time").val()},success:function(a){applyData(a);var b=document.getElementById("canvas").getContext("2d");window.myLine=new Chart(b,config),myLine.resize(600,1200)}})}function applyData(b){var a,c,d={label:"CPU",fill:!1,data:[]},e={label:"RAM",fill:!1,data:[]},f={label:"SWAP",fill:!1,data:[]},g={label:"Storage",fill:!1,data:[]};for(a in b)d.data.push({x:b[a].datetime,y:b[a].cpu}),e.data.push({x:b[a].datetime,y:b[a].ram}),f.data.push({x:b[a].datetime,y:b[a].swap}),g.data.push({x:b[a].datetime,y:b[a].storage});for(a=0,config.data.datasets=[d,e,f,g],config.data.datasets[0].backgroundColor=color(chartColors.red).alpha(.5).rgbString(),config.data.datasets[0].borderColor=chartColors.red,config.data.datasets[1].backgroundColor=color(chartColors.orange).alpha(.5).rgbString(),config.data.datasets[1].borderColor=chartColors.orange,config.data.datasets[2].backgroundColor=color(chartColors.yellow).alpha(.5).rgbString(),config.data.datasets[2].borderColor=chartColors.yellow,config.data.datasets[3].backgroundColor=color(chartColors.green).alpha(.5).rgbString(),config.data.datasets[3].borderColor=chartColors.green;a<config.data.datasets.length;a++)for(c=0;c<config.data.datasets[a].data.length;c++)config.data.datasets[a].data[c].x=newDateString(config.data.datasets[a].data[c].x)}$(document).ready(function(a){prepareTimeSelector(),$(document).on("change","#time",function(a){loadChart()}),loadChart()});var chartColors={red:"rgb(255, 99, 132)",orange:"rgb(255, 159, 64)",yellow:"rgb(255, 205, 86)",green:"rgb(75, 192, 192)",blue:"rgb(54, 162, 235)",purple:"rgb(153, 102, 255)",grey:"rgb(201, 203, 207)"},color=Chart.helpers.color,config={type:"line",data:{datasets:[]},options:{responsive:!0,title:{display:!0,text:"Server Status"},scales:{xAxes:[{type:"time",display:!0,scaleLabel:{display:!0,labelString:"Time"},ticks:{major:{fontStyle:"bold",fontColor:"#FF0000"}}}],yAxes:[{display:!0,scaleLabel:{display:!0,labelString:"Usage (%)"}}]}}}