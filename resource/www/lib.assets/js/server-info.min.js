function loadData(){$.ajax({type:"GET",url:"data/server-info/get",dataType:"json",success:function(e){updateCPUUsage(e),updateRAMStatus(e),updateSWAPStatus(e),updateStorageStatus(e),createCPUCore(e),updateCPUTemperatureStatus(e)}})}function reloadData(){$.ajax({type:"GET",url:"data/server-info/get",dataType:"json",success:function(e){$(".waiting-server-up").css({display:"none"}),updateCPUUsage(e),updateRAMStatus(e),updateSWAPStatus(e),updateStorageStatus(e),updateCPUTemperatureStatus(e)}})}function createCPUCore(e){for(var t in $(".cpu-temperature-container").empty(),e.cpu.temperature){var n=e.cpu.temperature[t],o=n.label,a=100*n.value.currentTemperature/150,a='<div class="server-into-item '+o.split(" ").join("-").toLowerCase()+'">\r\n<div class="info-label">'+o+'</div>\r\n<div class="info-value">'+n.raw.currentTemperature+'</div>\r\n<div class="info-progress">\r\n  <div class="info-progress-inner" style="width:'+a+'%"></div>\r\n</div>\r\n</div>\r\n';$(".cpu-temperature-container").append(a)}}function updateCPUTemperatureStatus(e){for(var t in e.cpu.temperature){var n=e.cpu.temperature[t],o=n.label,a=100*n.value.currentTemperature/150,o=o.split(" ").join("-").toLowerCase();$(".cpu-temperature-container").find("."+o).find(".info-value").html(n.raw.currentTemperature),$(".cpu-temperature-container").find("."+o).find(".info-progress-inner").css({width:a+"%"})}}function updateRAMStatus(e){var t,n;void 0!==e.memory.ram&&(t=e.memory.ram.used/e.memory.ram.total*100,n=e.memory.ram.total/1048576,e=e.memory.ram.used/1048576,$(".ram").find(".info-value").text(t.toFixed(2)+"% ("+e.toFixed(2)+"GB / "+n.toFixed(2)+"GB)"),$(".ram").find(".info-progress-inner").css({width:t.toFixed(2)+"%"}))}function updateSWAPStatus(e){var t,n;void 0!==e.memory.swap&&(t=e.memory.swap.used/e.memory.swap.total*100,n=e.memory.swap.total/1048576,e=e.memory.swap.used/1048576,$(".swap").find(".info-value").text(t.toFixed(2)+"% ("+e.toFixed(2)+"GB / "+n.toFixed(2)+"GB)"),$(".swap").find(".info-progress-inner").css({width:t.toFixed(2)+"%"}))}function updateStorageStatus(e){var t=e.storage.used/e.storage.total*100,n=e.storage.total/1048576,e=e.storage.used/1048576;$(".storage").find(".info-value").text(t.toFixed(2)+"% ("+e.toFixed(2)+"GB / "+n.toFixed(2)+"GB)"),$(".storage").find(".info-progress-inner").css({width:t.toFixed(2)+"%"})}function updateCPUUsage(e){e=e.cpu.usage.used;$(".cpu-usage").find(".info-value").text(e.toFixed(2)+"%"),$(".cpu-usage").find(".info-progress-inner").css({width:e.toFixed(2)+"%"})}$(document).ready(function(e){loadData(),setInterval(function(e){reloadData()},1e4),$(document).on("click",".service-item.service-modem .button-connect, .service-item.service-modem-sms .button-connect, .service-item.service-modem-internet .button-connect",function(e){var t="",t=$(this).closest(".service-item").hasClass("service-modem-sms")?"api/modem-sms":$(this).closest(".service-item").hasClass("service-modem-internet")?"api/modem-internet":"api/modem";$.ajax({url:t,type:"POST",data:{action:"connect"},dataType:"json",success:function(e){if("broadcast-message"==e.command)for(var t in e.data)console.log(e.data),showNotif(e.data[t].message)},error:function(e){}}),e.preventDefault()}),$(document).on("click",".service-item.service-modem .button-disconnect, .service-item.service-modem-sms .button-disconnect, .service-item.service-modem-internet .button-disconnect",function(e){var t="",t=$(this).closest(".service-item").hasClass("service-modem-sms")?"api/modem-sms":$(this).closest(".service-item").hasClass("service-modem-internet")?"api/modem-internet":"api/modem";confirm("Area you sure you want to disconnect all modems?")&&$.ajax({url:t,type:"POST",data:{action:"disconnect"},dataType:"json",success:function(e){if("broadcast-message"==e.command)for(var t in e.data)showNotif(e.data[t].message)},error:function(e){}}),e.preventDefault()}),$(document).on("click",".service-item.service-ws .button-connect",function(e){$.ajax({url:"api/subscriber-ws",type:"POST",data:{action:"start"},dataType:"json",success:function(e){},error:function(e){}}),e.preventDefault()}),$(document).on("click",".service-item.service-ws .button-disconnect",function(e){confirm("Are you sure you want to stop WebSocket client?")&&$.ajax({url:"api/subscriber-ws",type:"POST",data:{action:"stop"},dataType:"json",success:function(e){},error:function(e){}}),e.preventDefault()}),$(document).on("click",".service-item.service-amqp .button-connect",function(e){$.ajax({url:"api/subscriber-amqp",type:"POST",data:{action:"start"},dataType:"json",success:function(e){},error:function(e){}}),e.preventDefault()}),$(document).on("click",".service-item.service-amqp .button-disconnect",function(e){confirm("Are you sure you want to stop RabbitMQ client?")&&$.ajax({url:"api/subscriber-amqp",type:"POST",data:{action:"stop"},dataType:"json",success:function(e){},error:function(e){}}),e.preventDefault()}),$(document).on("click",".service-item.service-redis .button-connect",function(e){$.ajax({url:"api/subscriber-redis",type:"POST",data:{action:"start"},dataType:"json",success:function(e){},error:function(e){}}),e.preventDefault()}),$(document).on("click",".service-item.service-redis .button-disconnect",function(e){confirm("Are you sure you want to stop Redis client?")&&$.ajax({url:"api/subscriber-redis",type:"POST",data:{action:"stop"},dataType:"json",success:function(e){},error:function(e){}}),e.preventDefault()}),$(document).on("click",".service-item.service-mqtt .button-connect",function(e){$.ajax({url:"api/subscriber-mqtt",type:"POST",data:{action:"start"},dataType:"json",success:function(e){},error:function(e){}}),e.preventDefault()}),$(document).on("click",".service-item.service-mqtt .button-disconnect",function(e){confirm("Are you sure you want to stop Mosquitto client?")&&$.ajax({url:"api/subscriber-mqtt",type:"POST",data:{action:"stop"},dataType:"json",success:function(e){},error:function(e){}}),e.preventDefault()}),$(document).on("click",".service-item.service-http .button-connect",function(e){$.ajax({url:"api/subscriber-http",type:"POST",data:{action:"start"},dataType:"json",success:function(e){},error:function(e){}}),e.preventDefault()}),$(document).on("click",".service-item.service-http .button-disconnect",function(e){confirm("Are you sure you want to stop HTTP server?")&&$.ajax({url:"api/subscriber-http",type:"POST",data:{action:"stop"},dataType:"json",success:function(e){},error:function(e){}}),e.preventDefault()}),$(document).on("click",".service-item.service-https .button-connect",function(e){$.ajax({url:"api/subscriber-https",type:"POST",data:{action:"start"},dataType:"json",success:function(e){},error:function(e){}}),e.preventDefault()}),$(document).on("click",".service-item.service-https .button-disconnect",function(e){confirm("Are you sure you want to stop HTTPS server?")&&$.ajax({url:"api/subscriber-https",type:"POST",data:{action:"stop"},dataType:"json",success:function(e){},error:function(e){}}),e.preventDefault()}),$(document).on("click",".tile.reboot a",function(e){confirm("Are you sure you want to reboot the OS?")&&(waitingForServerUp(),$.ajax({url:"api/reboot",type:"POST",data:{confirm:"yes"},dataType:"json",success:function(e){},error:function(e){}}))}),$(document).on("click",".tile.restart a",function(e){confirm("Are you sure you want to restart the service?")&&(waitingForServerUp(),$.ajax({url:"api/restart",type:"POST",data:{confirm:"yes"},dataType:"json",success:function(e){},error:function(e){}}))}),$(document).on("click",".tile.expand a",function(e){confirm("Are you sure you want expand the storage?")&&$.ajax({url:"api/expand",type:"POST",data:{confirm:"yes"},dataType:"json",success:function(e){updateCPUUsage(e),updateRAMStatus(e),updateSWAPStatus(e),updateStorageStatus(e),updateCPUTemperatureStatus(e)},error:function(e){}})}),$(document).on("click",".tile.cleaner a",function(e){confirm("Are you sure you want to clean up the service?")&&$.ajax({url:"api/cleanup",type:"POST",data:{confirm:"yes"},dataType:"json",success:function(e){console.log("DATA : "+JSON.stringify(e))}})})});